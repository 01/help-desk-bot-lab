<!DOCTYPE html>
<html>

<head>
    <link href="https://unpkg.com/botframework-webchat/botchat.css" rel="stylesheet" />
    <style>
        .wc-chatview-panel {
            width: 380px;
            margin: 0 auto;
            border: 1px solid black;
        }

        aside {
            font-size: 12px;
            font-family: Arial, Helvetica, sans-serif;
            position: absolute;
            width: calc((100% - 400px) / 2);
            right: 0;
            color: #3a96dd;
        }

        aside div {
            color: black;
        }

        #results h3 {
            margin-top: 0;
            margin-bottom: 0;
        }

        #results span {
            color: #006621;
        }

        #results p {
            margin-top: 0;
            word-wrap: break-word;
            font-weight: normal;
        }
    </style>
</head>

<body>
    <div id="bot">
    </div>
    <aside>
        <h1>You might be interested in some of these related articles</h1>
        <div id="results">
            <p>no insights yet</p>
        </div>
    </aside>
    <script src="https://unpkg.com/botframework-webchat/botchat.js"></script>
    <script>
        var botConnection = new BotChat.DirectLine({
            secret: 'DIRECTLINE_SECRET'
        });
        var resPanel = document.getElementById('results');

        BotChat.App({
            botConnection: botConnection,
            user: { id: 'WebChatUser' },
            bot: { id: 'BOT_ID' },
            locale: 'en-us',
        }, document.getElementById("bot"));

        // catch incomming backchannel "event"
        botConnection.activity$
            .filter(function (activity) {
                return activity.type === 'event' && activity.name === 'searchResults';
            })
            .subscribe(function (activity) {
                updateSearchResults(activity.value)
            });

        function updateSearchResults(results) {
            console.log(results);
            resPanel.innerHTML = ''; // clear
            results.forEach(function (result) {
                resPanel.appendChild(createSearchResult(result));
            });
        }

        function createSearchResult(result) {
            var el = document.createElement('div');
            el.innerHTML = '<h3>' + result.Title + '</h3>' +
                '<p>' + result.Text.substring(0, 140) + '...</p>';
				
            return el;
        }
    </script>
</body>

</html>